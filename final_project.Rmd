---
title: "P8105 Final Project: Citi Bikes"
output: github_document
---

```{r, load required packages, include = FALSE}
library(tidyverse)

knitr::opts_chunk$set(
  eval = FALSE, 
  message = FALSE, 
  warning = FALSE
)
```

```{r, obtain a sample of rides from 2019-2020}
file_names <- list.files(path = "./data")
manhattan_stations <- read_csv("manhattan_stations.csv")

find_manhattan_rides <- function(data_name) {
  
  set.seed(8105)
  
  bike_rides_df <-
    read_csv(str_c("./data/", data_name)) %>% 
    janitor::clean_names() %>% 
    mutate(
      start_station_id = as.numeric(start_station_id), 
      end_station_id = as.numeric(end_station_id)
    ) %>% 
    filter(
      start_station_id %in% pull(manhattan_stations, id), 
      end_station_id %in% pull(manhattan_stations, id)
    ) %>% 
    sample_n(., 10000)
  
  return(bike_rides_df)
    
}

manhattan_rides_df <- map_df(file_names, find_manhattan_rides)
```
